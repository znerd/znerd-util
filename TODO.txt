------------------------------------------------------------------------------

Add unit tests.

------------------------------------------------------------------------------

Fix warnings about encoding.

------------------------------------------------------------------------------
